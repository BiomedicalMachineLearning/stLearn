

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>stlearn.pp.normalize_total &mdash; stLearn 0.3.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="stlearn.pp.scale" href="stlearn.pp.scale.html" />
    <link rel="prev" title="stlearn.pp.log1p" href="stlearn.pp.log1p.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> stLearn
          

          
          </a>

          
            
            
              <div class="version">
                0.3.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Content:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="api.html#module-stlearn.wrapper">Wrapper functions: <cite>wrapper</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-stlearn.add">Add: <cite>add</cite></a></li>
<li class="toctree-l2 current"><a class="reference internal" href="api.html#module-stlearn.pp">Preprocessing: <cite>pp</cite></a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="stlearn.pp.filter_genes.html">stlearn.pp.filter_genes</a></li>
<li class="toctree-l3"><a class="reference internal" href="stlearn.pp.log1p.html">stlearn.pp.log1p</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">stlearn.pp.normalize_total</a></li>
<li class="toctree-l3"><a class="reference internal" href="stlearn.pp.scale.html">stlearn.pp.scale</a></li>
<li class="toctree-l3"><a class="reference internal" href="stlearn.pp.neighbors.html">stlearn.pp.neighbors</a></li>
<li class="toctree-l3"><a class="reference internal" href="stlearn.pp.tiling.html">stlearn.pp.tiling</a></li>
<li class="toctree-l3"><a class="reference internal" href="stlearn.pp.extract_feature.html">stlearn.pp.extract_feature</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-stlearn.em">Embedding: <cite>em</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-stlearn.spatial">Spatial: <cite>spatial</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-stlearn.tl">Tools: <cite>tl</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#module-stlearn.pl">Plot: <cite>pl</cite></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="stlearn-interactive-tutorial.html">stLearn interactive web app tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="stSME_clustering.html">stSME clustering tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="stSME_comparison.html">stSME comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="Pseudo-time-space-tutorial.html">Spatial trajectory inference analysis tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="stLearn-CCI.html">stLearn Cell-cell interaction analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="Working-with-Old-Spatial-Transcriptomics-data.html">Working with Old Spatial Transcriptomics data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Read_slideseq.html">Working with slide-seq data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Read_MERFISH.html">Working with MERFISH data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Read_seqfish.html">Working with SeqFish data</a></li>
<li class="toctree-l1"><a class="reference internal" href="ST_deconvolution_visualization.html">Spatial transcriptomics deconvolution visualization</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">stLearn</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="api.html">API</a> &raquo;</li>
        
      <li>stlearn.pp.normalize_total</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/stlearn.pp.normalize_total.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="stlearn-pp-normalize-total">
<h1>stlearn.pp.normalize_total<a class="headerlink" href="#stlearn-pp-normalize-total" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="stlearn.pp.normalize_total">
<code class="sig-prename descclassname">stlearn.pp.</code><code class="sig-name descname">normalize_total</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">adata</span><span class="p">:</span> <span class="n">anndata._core.anndata.AnnData</span></em>, <em class="sig-param"><span class="n">target_sum</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">exclude_highly_expressed</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">max_fraction</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">key_added</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">layers</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>Literal<span class="p">[</span>all<span class="p">]</span><span class="p">, </span>Iterable<span class="p">[</span>str<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">layer_norm</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">inplace</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span> &#x2192; Optional<span class="p">[</span>Dict<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">]</span><a class="reference internal" href="_modules/stlearn/preprocessing/normalize.html#normalize_total"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#stlearn.pp.normalize_total" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap function from scanpy.pp.log1p
Normalize counts per cell.
If choosing <cite>target_sum=1e6</cite>, this is CPM normalization.
If <cite>exclude_highly_expressed=True</cite>, very highly expressed genes are excluded
from the computation of the normalization factor (size factor) for each
cell. This is meaningful as these can strongly influence the resulting
normalized values for all other genes <span id="id1">[Weinreb17]</span>.
Similar functions are used, for example, by Seurat <span id="id2">[Satija15]</span>, Cell Ranger
<span id="id3">[Zheng17]</span> or SPRING <span id="id4">[Weinreb17]</span>.
:param adata: The annotated data matrix of shape <cite>n_obs</cite> × <cite>n_vars</cite>.</p>
<blockquote>
<div><p>Rows correspond to cells and columns to genes.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_sum</strong> – If <cite>None</cite>, after normalization, each observation (cell) has a total
count equal to the median of total counts for observations (cells)
before normalization.</p></li>
<li><p><strong>exclude_highly_expressed</strong> – Exclude (very) highly expressed genes for the computation of the
normalization factor (size factor) for each cell. A gene is considered
highly expressed, if it has more than <cite>max_fraction</cite> of the total counts
in at least one cell. The not-excluded genes will sum up to
<cite>target_sum</cite>.</p></li>
<li><p><strong>max_fraction</strong> – If <cite>exclude_highly_expressed=True</cite>, consider cells as highly expressed
that have more counts than <cite>max_fraction</cite> of the original total counts
in at least one cell.</p></li>
<li><p><strong>key_added</strong> – Name of the field in <cite>adata.obs</cite> where the normalization factor is
stored.</p></li>
<li><p><strong>layers</strong> – List of layers to normalize. Set to <cite>‘all’</cite> to normalize all layers.</p></li>
<li><p><strong>layer_norm</strong> – <p>Specifies how to normalize layers:
* If <cite>None</cite>, after normalization, for each layer in <em>layers</em> each cell</p>
<blockquote>
<div><p>has a total count equal to the median of the <em>counts_per_cell</em> before
normalization of the layer.</p>
</div></blockquote>
<ul>
<li><p>If <cite>‘after’</cite>, for each layer in <em>layers</em> each cell has
a total count equal to <cite>target_sum</cite>.</p></li>
<li><p>If <cite>‘X’</cite>, for each layer in <em>layers</em> each cell has a total count
equal to the median of total counts for observations (cells) of
<cite>adata.X</cite> before normalization.</p></li>
</ul>
</p></li>
<li><p><strong>inplace</strong> – Whether to update <cite>adata</cite> or return dictionary with normalized copies of
<cite>adata.X</cite> and <cite>adata.layers</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Returns dictionary with normalized copies of <cite>adata.X</cite> and <cite>adata.layers</cite></p></li>
<li><p>or updates <cite>adata</cite> with normalized version of the original</p></li>
<li><p><cite>adata.X</cite> and <cite>adata.layers</cite>, depending on <cite>inplace</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="stlearn.pp.scale.html" class="btn btn-neutral float-right" title="stlearn.pp.scale" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="stlearn.pp.log1p.html" class="btn btn-neutral float-left" title="stlearn.pp.log1p" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Genomics and Machine Learning lab

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>